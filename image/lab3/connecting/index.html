<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>B. Accessing the headless RPI without network - Embedded systems</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../css/custom.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "B. Accessing the headless RPI without network";
        var mkdocs_page_input_path = "image/lab3/connecting.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../..">
          <img src="../../../img/tux-logo.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Raspberry Pi OS Labs</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" >Lab 1 - Setting-up Raspberry Pi OS Image</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../lab1/intro/">Lab 1 - Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../lab1/getting/">A. Getting the Raspberry Pi OS image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../lab1/mounting/">B. Mounting the Raspberry Pi OS image on the host</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../lab1/increasing/">C. Increasing size of Raspberry Pi OS image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../lab1/modifying/">D. Modifying the Raspberry Pi OS image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../lab1/executing/">E. Executing commands on the Raspberry Pi OS image</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Lab 2 - Running the Raspberry Pi OS on a virtual machine on host</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../lab2/intro/">Lab 2 - Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../lab2/getting/">A. Getting the Raspberry Pi OS image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../lab2/installVM/">B. Install QEMU ARM virtual machine (VM)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../lab2/using/">C. Using QEMU Virtual Machine</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >Lab 3 - Setting-up and working with the Raspberry Pi OS without graphical user interface</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../intro/">Lab 3 - Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../writing/">A. Writing the Raspberry Pi OS image on the sd-card</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">B. Accessing the headless RPI without network</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#headless-raspberry-pi">Headless Raspberry Pi</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#enable-serial-interface-and-login-shell-over-serial">Enable serial interface and login shell over serial</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#connecting-the-debug-console">Connecting the debug console</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#set-up-the-ftdi-usb-cable-connection-on-a-serial-port-of-the-host">Set-up the FTDI USB cable connection on a serial port of the host</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#access-the-rpi-from-the-host">Access the RPI from the host</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../setting/">C. Setting up network for ssh access</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../saving/">D. Cloning the image</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">QEMU</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../qemu/">Introduction to QEMU</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">Embedded systems</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Raspberry Pi OS Labs</li>
          <li class="breadcrumb-item">Lab 3 - Setting-up and working with the Raspberry Pi OS without graphical user interface</li>
      <li class="breadcrumb-item active">B. Accessing the headless RPI without network</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="b-accessing-the-headless-rpi-without-network">B. Accessing the headless RPI without network</h1>
<h2 id="headless-raspberry-pi">Headless Raspberry Pi</h2>
<p>For convenience or to save space and money, we don't want to use additional hardware components such as a monitor, keyboard, or mouse to access our Raspberry Pi, especially with a desktopless OS such as our Lite version of Raspberry Pi OS.<br />
We call this screenless setup a headless Raspberry Pi.  </p>
<p>There are different ways to configure a headless Raspberry Pi, here are three :</p>
<ul>
<li><strong>Serial Terminal</strong> - This requires extra hardware in the form of a serial-to-USB adapter, but it is by far the most robust way to connect, as you are not relying on any network setup.</li>
<li><strong>Ethernet with Static IP Address</strong> - This method requires a Linux operating system to change some files on the Raspberry Pi image. You can give the Raspberry Pi a static IP address and then use an Ethernet cable (or WiFi) to log in.</li>
<li><strong>WiFi with DHCP</strong> - You will need to have access to your router to find your Raspberry Pi's IP address in order to log in via SSH. As a result, this may not be the best option in school or office environments.</li>
</ul>
<p>If you would like to access your Raspberry Pi using the least amount of software work or without network, you will need some extra hardware. Two of the pins on the Raspberry Pi offer transmit and receive data for serial communication. With a small change to a file on the boot sector of the SD card, a command line terminal will be broadcast over this serial line, and you can enter commands to control Linux, write programs, etc.</p>
<p>If the other methods do not work to gain access to your Raspberry Pi or you lose your video out signal, using the serial terminal is a great way to see if your Raspberry Pi is still working and to debug any problems you might have.</p>
<p>You will need a USB to serial converter for this to work.</p>
<p><img alt="" src="../../../img/serial-to-usb.png" /></p>
<h2 id="enable-serial-interface-and-login-shell-over-serial">Enable serial interface and login shell over serial</h2>
<p>In versions of the Raspberry Pi after 3 (e.g. 3 Model B, 3 Model B+, Zero W), the processor contains two hardware UARTs. One is dedicated to the Bluetooth module, while the other is a less-featured "mini UART."</p>
<p>The serial interface is not enabled by default on the board, but we have already enabled it in Lab 1.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If Lab 1 made you use <code>raspi-config</code> to enable UART, it may have failed even if your setup was correct.<br />
In fact, <code>raspi-config</code> needs a real Raspberry Pi kernel to work well, and QEMU is not sufficient.<br />
But good news, most things <code>raspi-config</code> does are just file edits, so we can do it safely manually.</p>
</div>
<p>We will make sure the serial interface is enabled :  </p>
<ul>
<li>Plug your sd-card and make sure its partitions are mounted  </li>
<li>Look for a <code>config.txt</code> file in <code>/boot</code> and open it.</li>
<li>Now check there is the line <code>enable_uart=1</code> under the <code>[all]</code> section, if that's not the case add it, save and exit.</li>
</ul>
<p>The sd-card can now be unmounted from your computer.</p>
<h2 id="connecting-the-debug-console">Connecting the debug console</h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure the Raspberry Pi is off (not powered) before proceeding the following steps !</p>
</div>
<p>First, insert the sd-card in the Raspberry Pi</p>
<p>The console will be connected on the I/O ports on the RPI board
and on an USB input of the host computer.</p>
<p>The serial to USB adapter is a FTDI USB cable with 3, 4 or 6 ”Arduino like” terminations
to be plugged on the RPI board, you can find some information in
the data sheet of the cable :</p>
<ul>
<li>The one with 3 terminations : <a href="https://www.mouser.fr/datasheet/2/163/DS_TTL-232R_RPi-267577.pdf">https://www.mouser.fr/datasheet/2/163/DS_TTL-232R_RPi-267577.pdf</a></li>
<li>The one with 6 terminations : <a href="https://cdn.robotshop.com/media/s/spa/rb-spa-432/pdf/ftdi-cable-schematic-dev-09718.pdf">https://cdn.robotshop.com/media/s/spa/rb-spa-432/pdf/ftdi-cable-schematic-dev-09718.pdf</a></li>
<li>The one with 4 terminations : <a href="https://www.adafruit.com/product/954?srsltid=AfmBOoploJ4nyapeY4tQLdr9ZWopzSrvJaUvqjKPwxA8N61XxzHrdqi4">https://www.adafruit.com/product/954?srsltid=AfmBOoploJ4nyapeY4tQLdr9ZWopzSrvJaUvqjKPwxA8N61XxzHrdqi4</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Caution! The GPIO pins on the Raspberry Pi are NOT 5V tolerant. That means you must use a 3.3V USB-to-serial converter.</p>
</div>
<p>Look at the GPIO pinout for the Raspberry Pi 3, and find the UART pins.
Plug the 3 necessary terminations of the FTDI USB cable on the board accordingly.</p>
<p><img alt="" src="../../../img/Raspberry_Pi_3_Pinout.png" /></p>
<p>Now this is done, power up the board !</p>
<h2 id="set-up-the-ftdi-usb-cable-connection-on-a-serial-port-of-the-host">Set-up the FTDI USB cable connection on a serial port of the host</h2>
<p>First, let's get the name of the serial port on the host.
The /dev/ directory consists of files that represent devices that are attached to the local system.  </p>
<p>Before plugin the FTDI USB cable,<br />
check the system messages :</p>
<p><div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dmesg
</code></pre></div>
and list the devices :</p>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>/dev<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;tty&quot;</span>
</code></pre></div>
<p>Now, plug the FTDI cable and check again. <code>dmesg</code> should tell you about a new connection and the devices list should display a new device</p>
<div class="admonition note">
<p class="admonition-title">1 - Issue</p>
<p>Find the name of the serial port. It should be something like <code>/dev/tty*</code>  </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using Windows, you will need to know the COM port number connected to your USB to serial adapter, which can be found in the Device Manager</p>
</div>
<!-- !!! Tip "1 - Solution"

    The name of serial port should be something like /dev/ttyUSB0 -->

<p>Check it works with :
<div class="highlight"><pre><span></span><code>stty<span class="w"> </span>-F<span class="w"> </span>&lt;serial_port_name&gt;
</code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the command works only with sudo, you need to be added to the dialout group.<br />
First, check the groups you are member of :
<div class="highlight"><pre><span></span><code>groups
</code></pre></div>
If dialout is not in the list , do
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>usermod<span class="w"> </span>-a<span class="w"> </span>-G<span class="w"> </span>dialout<span class="w"> </span><span class="nv">$USER</span>
</code></pre></div>
and restart the computer ... or not !!!
if you don’t want to restart the session, remember this trick
<div class="highlight"><pre><span></span><code>su<span class="w"> </span>-<span class="w"> </span><span class="nv">$USER</span>
</code></pre></div>
now dialout should be in the group list
<div class="highlight"><pre><span></span><code>groups
</code></pre></div></p>
</div>
<h2 id="access-the-rpi-from-the-host">Access the RPI from the host</h2>
<p>Once the RPI boot has booted, we can access it from the host with
tools like <code>minicom</code>.</p>
<p>the speed should be 115200 bauds</p>
<div class="admonition note">
<p class="admonition-title">2 - Issue</p>
<p>Start minicom specifying the device name and a baudrate of 115200 using the correct options</p>
</div>
<!-- !!! Tip "2 - Solution"

    ```bash
    minicom -b 115200 -D /dev/ttyUSB0
    ``` -->

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On windows use Putty is a straight-forward solution to connect to serial ports<br />
If you still pefer using minicom under WSL, you need to use <code>usbipd</code> but it needs more setup</p>
</div>
<p>The first time using minicom, the "Hardware control flow" must be disabled :</p>
<ul>
<li>type ctrl-A the o to access the configuration</li>
<li>select "Serial port setup"</li>
<li>type F to disable Hardware Flow Control</li>
<li>select "Save setup as dfl" so that next time you will not need to reconfigure</li>
<li>finally select "Exit"</li>
</ul>
<p>The login prompt should appear one or two minutes after powering
the RPI board. Type user and passwd to log in. You can use <strong>ue41</strong>
user you have created in Lab 1.</p>
<p>Check your hostname is the one you set in Lab 1 :</p>
<div class="highlight"><pre><span></span><code>hostname
</code></pre></div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../writing/" class="btn btn-neutral float-left" title="A. Writing the Raspberry Pi OS image on the sd-card"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../setting/" class="btn btn-neutral float-right" title="C. Setting up network for ssh access">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../writing/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../setting/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
